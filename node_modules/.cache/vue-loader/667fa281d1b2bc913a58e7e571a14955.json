{"remainingRequest":"/Users/work/webworkspace/cxy-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/work/webworkspace/cxy-web/src/views/system/role/AuthForm.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/work/webworkspace/cxy-web/src/views/system/role/AuthForm.vue","mtime":1610414323399},{"path":"/Users/work/webworkspace/cxy-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/work/webworkspace/cxy-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/work/webworkspace/cxy-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/work/webworkspace/cxy-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGdldFJvbGVSZXNvdXJlSWRzLCBzZXRSb2xlQXV0aG9yaXRpZXMsIHF1ZXJ5TWVudUxpc3QgfSBmcm9tICdAL2FwaS9yb2xlJwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdBdXRoRm9ybScsCiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHZ1ZS9yZXF1aXJlLXByb3AtdHlwZXMKICBwcm9wczogWyd2aXNhYmxlJywgJ3JvbGVJZCddLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBjaGVja2VkS2V5czogW10sCiAgICAgIGRhdGE6IFsvKiB7CiAgICAgICAgICAgICAgaWQ6IDEsCiAgICAgICAgICAgICAgbmFtZTogJ+ezu+e7n+euoeeQhicsCiAgICAgICAgICAgICAgaXNNZW51OnRydWUsCiAgICAgICAgICAgICAgY2hpbGRyZW46IFt7CiAgICAgICAgICAgICAgICBpZDogNCwKICAgICAgICAgICAgICAgIG5hbWU6ICfnlKjmiLfnrqHnkIYnLAogICAgICAgICAgICAgICAgaXNNZW51OnRydWUsCiAgICAgICAgICAgICAgICBjaGlsZHJlbjogW3sKICAgICAgICAgICAgICAgICAgaWQ6IDksCiAgICAgICAgICAgICAgICAgIG5hbWU6ICfnlKjmiLfliKDpmaQnLAogICAgICAgICAgICAgICAgICBpc01lbnU6ZmFsc2UKICAgICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICAgaWQ6IDEwLAogICAgICAgICAgICAgICAgICBuYW1lOiAn55So5oi35L+u5pS5JywKICAgICAgICAgICAgICAgICAgaXNNZW51OmZhbHNlCiAgICAgICAgICAgICAgICB9XQogICAgICAgICAgICAgIH1dCiAgICAgICAgICAgIH0qL10sCiAgICAgIGRlZmF1bHRQcm9wczogewogICAgICAgIGNoaWxkcmVuOiAnY2hpbGRyZW4nLAogICAgICAgIGxhYmVsOiAnbmFtZScKICAgICAgfQogICAgfQogIH0sCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMuZ2V0QXV0aG9yaXRpZXMoKQogIH0sCiAgbWV0aG9kczogewogICAgaGFuZGxlU3VibWl0KCkgewogICAgICAvLyBmYWxzZSDmmK/lkKblj6rljIXlkKvlj7blrZDoioLngrkgICAgLy90cnVlIOaYr+WQpuWMheWQq+WNiumAieeKtuaAgeiKgueCuQoKICAgICAgY29uc3QgaGFsZlRyZWVLZXlzID0gdGhpcy4kcmVmcy50cmVlLmdldEhhbGZDaGVja2VkS2V5cygpCiAgICAgIGNvbnNvbGUubG9nKGhhbGZUcmVlS2V5cykKICAgICAgY29uc3QgdHJlZUtleXMgPSB0aGlzLiRyZWZzLnRyZWUuZ2V0Q2hlY2tlZEtleXMoKQogICAgICBzZXRSb2xlQXV0aG9yaXRpZXModGhpcy5yb2xlSWQsIGhhbGZUcmVlS2V5cy5jb25jYXQodHJlZUtleXMpKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICB0aGlzLmhhbmRsZUNsb3NlKCkKICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgIHNob3dDbG9zZTogdHJ1ZSwKICAgICAgICAgIG1lc3NhZ2U6ICfmnYPpmZDorr7nva7miJDlip8nLAogICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnCiAgICAgICAgfSkKICAgICAgfSkuY2F0Y2goZXJyb3IgPT4gewogICAgICAgIGNvbnNvbGUubG9nKGVycm9yKQogICAgICB9KQogICAgfSwKICAgIGdldEF1dGhvcml0aWVzKCkgewogICAgICBjb25zdCB0aGF0ID0gdGhpcwogICAgICBnZXRSb2xlUmVzb3VyZUlkcyh0aGlzLnJvbGVJZCkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgdGhhdC5jaGVja2VkS2V5cyA9IHJlc3BvbnNlLmRhdGEuZGF0YQogICAgICB9KS5jYXRjaChlcnJvciA9PiB7CiAgICAgICAgY29uc29sZS5sb2coZXJyb3IpCiAgICAgIH0pCiAgICAgIGNvbnNvbGUubG9nKHRoaXMuY2hlY2tlZEtleXMpCiAgICAgIHF1ZXJ5TWVudUxpc3QoKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICB0aGlzLmRhdGEgPSByZXNwb25zZS5kYXRhLmRhdGEKICAgICAgfSkuY2F0Y2goZXJyb3IgPT4gewogICAgICAgIGNvbnNvbGUubG9nKGVycm9yKQogICAgICB9KQogICAgfSwKICAgIHJlbmRlckNvbnRlbnQoaCwgeyBub2RlLCBkYXRhLCBzdG9yZSB9KSB7CiAgICAgIHJldHVybiAoCiAgICAgICAgPHNwYW4gY2xhc3M9J2N1c3RvbS10cmVlLW5vZGUnPgogICAgICAgICAge3RoaXMuaWNvbkNsYXNzKGRhdGEuaXNNZW51KX0KICAgICAgICAgIDxzcGFuIHN0eWxlPSdtYXJnaW4tbGVmdDo1cHg7Jz57bm9kZS5sYWJlbH08L3NwYW4+CiAgICAgICAgPC9zcGFuPgogICAgICApCiAgICB9LAogICAgaWNvbkNsYXNzKGlzTWVudSkgewogICAgICBpZiAoaXNNZW51KSB7CiAgICAgICAgcmV0dXJuIDxpIHYtZWxzZSBjbGFzcz0nZWwtaWNvbi1tZW51Jz48L2k+CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIDxpIGNsYXNzPSdlbC1pY29uLWRvY3VtZW50Jz48L2k+CiAgICAgIH0KICAgIH0sCiAgICBoYW5kbGVDbG9zZSgpIHsKICAgICAgdGhpcy4kZW1pdCgnaGFuZGxlQXV0aEhpZGUnKQogICAgfSwKICAgIGhhbmRsZVJlc2V0KCkgewogICAgICB0aGlzLiRyZWZzLnRyZWUuc2V0Q2hlY2tlZEtleXMoW10pCiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["AuthForm.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AA2BA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"AuthForm.vue","sourceRoot":"src/views/system/role","sourcesContent":["<template>\n  <el-dialog\n    title=\"权限控制\"\n    :visible=\"visable\"\n    width=\"30%\"\n    :modal=\"false\"\n    :before-close=\"handleClose\"\n  >\n    <el-tree\n      ref=\"tree\"\n      default-expand-all\n      :data=\"data\"\n      show-checkbox\n      node-key=\"id\"\n      :default-checked-keys=\"checkedKeys\"\n      :props=\"defaultProps\"\n      highlight-current\n      :render-content=\"renderContent\"\n    />\n    <span slot=\"footer\" class=\"dialog-footer\">\n      <el-button @click=\"handleReset\">重 置</el-button>\n      <el-button type=\"primary\" @click=\"handleSubmit('form')\">确 定</el-button>\n    </span>\n  </el-dialog>\n</template>\n\n<script>\nimport { getRoleResoureIds, setRoleAuthorities, queryMenuList } from '@/api/role'\n\nexport default {\n  name: 'AuthForm',\n  // eslint-disable-next-line vue/require-prop-types\n  props: ['visable', 'roleId'],\n  data() {\n    return {\n      checkedKeys: [],\n      data: [/* {\n              id: 1,\n              name: '系统管理',\n              isMenu:true,\n              children: [{\n                id: 4,\n                name: '用户管理',\n                isMenu:true,\n                children: [{\n                  id: 9,\n                  name: '用户删除',\n                  isMenu:false\n                }, {\n                  id: 10,\n                  name: '用户修改',\n                  isMenu:false\n                }]\n              }]\n            }*/],\n      defaultProps: {\n        children: 'children',\n        label: 'name'\n      }\n    }\n  },\n  created() {\n    this.getAuthorities()\n  },\n  methods: {\n    handleSubmit() {\n      // false 是否只包含叶子节点    //true 是否包含半选状态节点\n\n      const halfTreeKeys = this.$refs.tree.getHalfCheckedKeys()\n      console.log(halfTreeKeys)\n      const treeKeys = this.$refs.tree.getCheckedKeys()\n      setRoleAuthorities(this.roleId, halfTreeKeys.concat(treeKeys)).then(response => {\n        this.handleClose()\n        this.$message({\n          showClose: true,\n          message: '权限设置成功',\n          type: 'success'\n        })\n      }).catch(error => {\n        console.log(error)\n      })\n    },\n    getAuthorities() {\n      const that = this\n      getRoleResoureIds(this.roleId).then(response => {\n        that.checkedKeys = response.data.data\n      }).catch(error => {\n        console.log(error)\n      })\n      console.log(this.checkedKeys)\n      queryMenuList().then(response => {\n        this.data = response.data.data\n      }).catch(error => {\n        console.log(error)\n      })\n    },\n    renderContent(h, { node, data, store }) {\n      return (\n        <span class='custom-tree-node'>\n          {this.iconClass(data.isMenu)}\n          <span style='margin-left:5px;'>{node.label}</span>\n        </span>\n      )\n    },\n    iconClass(isMenu) {\n      if (isMenu) {\n        return <i v-else class='el-icon-menu'></i>\n      } else {\n        return <i class='el-icon-document'></i>\n      }\n    },\n    handleClose() {\n      this.$emit('handleAuthHide')\n    },\n    handleReset() {\n      this.$refs.tree.setCheckedKeys([])\n    }\n  }\n}\n</script>\n\n<style scoped>\n  .custom-tree-node {\n    flex: 1;\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    font-size: 14px;\n    padding-right: 8px;\n  }\n</style>\n"]}]}
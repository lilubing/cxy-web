{"remainingRequest":"/Users/work/webworkspace/cxy-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/work/webworkspace/cxy-web/src/views/system/user/user.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"/Users/work/webworkspace/cxy-web/src/views/system/user/user.vue","mtime":1610411801923},{"path":"/Users/work/webworkspace/cxy-web/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/work/webworkspace/cxy-web/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/work/webworkspace/cxy-web/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/work/webworkspace/cxy-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/work/webworkspace/cxy-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5lbC1wYWdpbmF0aW9uIHsKICBmbG9hdDogcmlnaHQ7CiAgbWFyZ2luLXRvcDogMTVweDsKfQo="},{"version":3,"sources":["user.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqOA;AACA;AACA;AACA","file":"user.vue","sourceRoot":"src/views/system/user","sourcesContent":["<template>\n\n  <imp-panel>\n    <h3 slot=\"header\" class=\"box-title\" style=\"width: 100%;\">\n      <el-row style=\"width: 100%;\">\n        <el-col :span=\"12\">\n          <router-link :to=\"{ path: 'userAdd'}\">\n            <el-button type=\"primary\" icon=\"plus\">新增</el-button>\n          </router-link>\n        </el-col>\n        <el-col :span=\"12\">\n          <div class=\"el-input\" style=\"width: 200px; float: right;\">\n            <i class=\"el-input__icon el-icon-search\" />\n            <input\n              v-model=\"searchKey\"\n              type=\"text\"\n              placeholder=\"输入用户名称\"\n              class=\"el-input__inner\"\n              @keyup.enter=\"search($event)\"\n            >\n          </div>\n        </el-col>\n      </el-row>\n    </h3>\n    <div slot=\"body\">\n      <el-table\n        v-loading=\"listLoading\"\n        :data=\"tableData.rows\"\n        border\n        style=\"width: 100%\"\n        @selection-change=\"handleSelectionChange\"\n      >\n        <!--checkbox 适当加宽，否则IE下面有省略号 https://github.com/ElemeFE/element/issues/1563-->\n        <el-table-column\n          prop=\"id\"\n          type=\"selection\"\n          width=\"50\"\n        />\n        <el-table-column\n          label=\"照片\"\n          width=\"76\"\n        >\n          <template slot-scope=\"scope\">\n            <img :src=\"scope.row.avatar\" style=\"height: 35px;vertical-align: middle;\" alt=\"\">\n          </template>\n        </el-table-column>\n        <el-table-column\n          prop=\"name\"\n          label=\"名称\"\n        />\n        <el-table-column\n          prop=\"nickName\"\n          label=\"登录用户名\"\n        />\n        <el-table-column\n          prop=\"email\"\n          label=\"邮箱\"\n        />\n        <el-table-column\n          label=\"状态\"\n        >\n          <template slot-scope=\"scope\">\n            {{ scope.row.status===1 ? '已激活' : '未激活' }}\n          </template>\n        </el-table-column>\n        <el-table-column label=\"操作\" width=\"285\">\n          <template slot-scope=\"scope\">\n            <el-button\n              size=\"small\"\n              type=\"default\"\n              icon=\"edit\"\n              @click=\"handleEdit(scope.$index, scope.row)\"\n            >编辑\n            </el-button>\n            <el-button\n              size=\"small\"\n              type=\"info\"\n              icon=\"setting\"\n              @click=\"handleRoleConfig(scope.$index, scope.row)\"\n            >配置角色\n            </el-button>\n            <el-button\n              size=\"small\"\n              type=\"danger\"\n              @click=\"handleDelete(scope.$index, scope.row)\"\n            >删除\n            </el-button>\n          </template>\n        </el-table-column>\n      </el-table>\n\n      <el-pagination\n        :current-page=\"tableData.pagination.pageNo\"\n        :page-sizes=\"[5, 10, 20]\"\n        :page-size=\"tableData.pagination.pageSize\"\n        layout=\"total, sizes, prev, pager, next, jumper\"\n        :total=\"tableData.pagination.total\"\n        @size-change=\"handleSizeChange\"\n        @current-change=\"handleCurrentChange\"\n      />\n\n      <el-dialog v-model=\"dialogVisible\" title=\"配置用户角色\" size=\"tiny\">\n        <div class=\"select-tree\">\n          <el-scrollbar\n            tag=\"div\"\n            class=\"is-empty\"\n            wrap-class=\"el-select-dropdown__wrap\"\n            view-class=\"el-select-dropdown__list\"\n          >\n            <el-tree\n              ref=\"roleTree\"\n              v-loading=\"dialogLoading\"\n              :data=\"roleTree\"\n              show-checkbox\n              check-strictly\n              node-key=\"id\"\n              :props=\"defaultProps\"\n            />\n          </el-scrollbar>\n        </div>\n        <span slot=\"footer\" class=\"dialog-footer\">\n          <el-button @click=\"dialogVisible = false\">取 消</el-button>\n          <el-button type=\"primary\" @click=\"configUserRoles\">确 定</el-button>\n        </span>\n      </el-dialog>\n    </div>\n\n  </imp-panel>\n</template>\n\n<script>\nimport panel from '../../components/panel.vue'\nimport * as api from '../../api'\nimport testData from '../../../static/data/data.json'\nimport * as sysApi from '../../services/sys'\n\nexport default {\n  components: {\n    'imp-panel': panel\n  },\n  data() {\n    return {\n      currentRow: {},\n      dialogVisible: false,\n      dialogLoading: false,\n      defaultProps: {\n        children: 'children',\n        label: 'name',\n        id: 'id'\n      },\n      roleTree: [],\n      listLoading: false,\n      searchKey: '',\n      tableData: {\n        pagination: {\n          total: 0,\n          pageNo: 1,\n          pageSize: 10,\n          parentId: 0\n        },\n        rows: []\n      }\n    }\n  },\n  created() {\n    this.loadData()\n  },\n  methods: {\n    search(target) {\n      this.loadData()\n    },\n    handleSelectionChange(val) {\n\n    },\n    handleRoleConfig(index, row) {\n      this.currentRow = row\n      this.dialogVisible = true\n      if (this.roleTree.length <= 0) {\n        sysApi.roleList({ selectChildren: true })\n          .then(res => {\n            this.roleTree = res\n          })\n      }\n      this.$http.get(api.SYS_USER_ROLE + '?id=' + row.id)\n        .then(res => {\n          this.$refs.roleTree.setCheckedKeys(res.data)\n        }).catch(err => {\n\n        })\n    },\n    configUserRoles() {\n      const checkedKeys = this.$refs.roleTree.getCheckedKeys()\n      this.$http.get(api.SYS_SET_USER_ROLE + '?userId=' + this.currentRow.id + '&roleIds=' + checkedKeys.join(','))\n        .then(res => {\n          this.$message('修改成功')\n          this.dialogVisible = false\n        })\n    },\n    handleSizeChange(val) {\n      this.tableData.pagination.pageSize = val\n      this.loadData()\n    },\n    handleCurrentChange(val) {\n      this.tableData.pagination.pageNo = val\n      this.loadData()\n    },\n    handleEdit(index, row) {\n      this.$router.push({ path: 'userAdd', query: { id: row.id }})\n    },\n    handleDelete(index, row) {\n      this.$http.get(api.SYS_USER_DELETE + '?userIds=' + row.id).then(res => {\n        this.loadData()\n      })\n    },\n    loadData() {\n      sysApi.userList({\n        key: this.searchKey,\n        pageSize: this.tableData.pagination.pageSize,\n        pageNo: this.tableData.pagination.pageNo\n      })\n        .then(res => {\n          this.tableData.rows = res.records\n          this.tableData.pagination.total = res.total\n        })\n    }\n  }\n}\n</script>\n<style>\n  .el-pagination {\n    float: right;\n    margin-top: 15px;\n  }\n</style>\n"]}]}
{"remainingRequest":"/Users/work/webworkspace/cxy-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/work/webworkspace/cxy-web/src/views/system/role/AuthForm.vue?vue&type=style&index=0&id=3688e642&scoped=true&lang=css&","dependencies":[{"path":"/Users/work/webworkspace/cxy-web/src/views/system/role/AuthForm.vue","mtime":1611017324525},{"path":"/Users/work/webworkspace/cxy-web/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/work/webworkspace/cxy-web/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/work/webworkspace/cxy-web/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/work/webworkspace/cxy-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/work/webworkspace/cxy-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgouY3VzdG9tLXRyZWUtbm9kZSB7CiAgZmxleDogMTsKICBkaXNwbGF5OiBmbGV4OwogIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOwogIGZvbnQtc2l6ZTogMTRweDsKICBwYWRkaW5nLXJpZ2h0OiA4cHg7Cn0K"},{"version":3,"sources":["AuthForm.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"AuthForm.vue","sourceRoot":"src/views/system/role","sourcesContent":["<template>\n  <el-dialog\n    title=\"权限控制\"\n    :visible=\"visable\"\n    width=\"30%\"\n    :modal=\"false\"\n    :before-close=\"handleClose\"\n  >\n    <el-tree\n      ref=\"tree\"\n      default-expand-all\n      :data=\"data\"\n      show-checkbox\n      node-key=\"menuButtonId\"\n      :default-checked-keys=\"checkedKeys\"\n      :props=\"defaultProps\"\n      highlight-current\n      :check-strictly=\"true\"\n      :render-content=\"renderContent\"\n      @check-change=\"handleCheckChange\"\n    />\n    <span slot=\"footer\" class=\"dialog-footer\">\n      <el-button @click=\"handleReset\">重 置</el-button>\n      <el-button type=\"primary\" @click=\"handleClose\">关 闭</el-button>\n      <!-- <el-button type=\"primary\" @click=\"handleSubmit('form')\">确 定</el-button> -->\n    </span>\n  </el-dialog>\n</template>\n\n<script>\nimport { getMenuButtonsTreeByRoleId, setRoleAuthorities } from '@/api/role'\n\nexport default {\n  name: 'AuthForm',\n  // eslint-disable-next-line vue/require-prop-types\n  props: ['visable', 'roleId'],\n  data() {\n    return {\n      checkedKeys: [],\n      data: [/* {\n              id: 1,\n              name: '系统管理',\n              isMenu:true,\n              children: [{\n                id: 4,\n                name: '用户管理',\n                isMenu:true,\n                children: [{\n                  id: 9,\n                  name: '用户删除',\n                  isMenu:false\n                }, {\n                  id: 10,\n                  name: '用户修改',\n                  isMenu:false\n                }]\n              }]\n            }*/],\n      defaultProps: {\n        children: 'children',\n        label: 'name'\n      }\n    }\n  },\n  created() {\n    this.getAuthorities()\n  },\n  methods: {\n    handleSubmit() {\n      // false 是否只包含叶子节点    //true 是否包含半选状态节点\n      const halfTreeKeys = this.$refs.tree.getHalfCheckedKeys()\n      console.log(halfTreeKeys)\n      const treeKeys = this.$refs.tree.getCheckedKeys()\n      setRoleAuthorities(this.roleId, halfTreeKeys.concat(treeKeys)).then(response => {\n        this.handleClose()\n        this.$message({\n          showClose: true,\n          message: '权限设置成功',\n          type: 'success'\n        })\n      }).catch(error => {\n        console.log(error)\n      })\n    },\n    getAuthorities() {\n      // const that = this\n      getMenuButtonsTreeByRoleId(this.roleId).then(response => {\n        this.data = response.data\n        this.getAllCheckedKeys(response.data)\n      }).catch(error => {\n        console.log(error)\n      })\n    },\n    getAllCheckedKeys(resultData) {\n      resultData.forEach(item => {\n        if (undefined !== item.checked) {\n          this.checkedKeys.push(item.menuButtonId)\n        }\n        if (undefined !== item.children) {\n          this.getAllCheckedKeys(item.children)\n        }\n      })\n    },\n    renderContent(h, { node, data, store }) {\n      return (\n        <span class='custom-tree-node'>\n          {this.iconClass(data.type)}\n          <span style='margin-left:5px;'>{node.label}</span>\n        </span>\n      )\n    },\n    iconClass(type) {\n      if (type) {\n        return <i class='el-icon-document'></i>\n      } else {\n        return <i class='el-icon-menu'></i>\n      }\n    },\n    handleCheckChange(data, checked, indeterminate) {\n      setRoleAuthorities(data.menuButtonId, checked, this.roleId).then(response => {\n        this.$message({\n          showClose: true,\n          message: '权限设置成功',\n          type: 'success'\n        })\n      }).catch(error => {\n        console.log(error)\n      })\n    },\n    handleClose() {\n      this.$emit('handleAuthHide')\n    },\n    handleReset() {\n      this.$refs.tree.setCheckedKeys([])\n    }\n  }\n}\n</script>\n\n<style scoped>\n  .custom-tree-node {\n    flex: 1;\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    font-size: 14px;\n    padding-right: 8px;\n  }\n</style>\n"]}]}